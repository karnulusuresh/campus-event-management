<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sign Up | Campus Event System</title>
  <link rel="stylesheet" href="signup.css" />
</head>
<body>
  <div class="auth-container">
    <h2>Create Account</h2>
    <form id="signupForm">
      <div class="form-group">
        <label>Name</label>
        <input type="text" id="name" required placeholder="Full Name" />
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="email" required placeholder="Enter Email" />
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="password" required placeholder="Enter Password" />
      </div>
      <div class="form-group">
        <label>Role</label>
        <select id="roleId">
          <option value="1">ADMIN</option>
          <option value="2">FACULTY</option>
          <option value="3">STUDENT</option>
        </select>
      </div>
      <button type="submit" class="btn">Sign Up</button>
      <p id="errorMessage" class="error-text"></p>
    </form>
    <p>Already have an account? <a href="login.html">Login</a></p>
  </div>

  <script>
    // SIGNUP
    const BASE_URL = "http://localhost:8080/api";
const signupForm = document.getElementById("signupForm");
if (signupForm) {
  const roleMap = {
    "ADMIN": 1,
    "FACULTY": 2,
    "STUDENT": 3
  };

  signupForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    const roleName = document.getElementById("roleId").value; // this is role name string now
    const user = {
      name: document.getElementById("name").value,
      email: document.getElementById("email").value,
      password: document.getElementById("password").value,
      roleId: roleMap[roleName] || 3 // fallback to STUDENT if not found
    };

    try {
      const res = await fetch(`${BASE_URL}/users`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(user),
      });
      if (!res.ok) throw new Error("Failed to sign up");
      alert("Signup successful! Please login.");
      window.location.href = "login.html";
    } catch (err) {
      document.getElementById("errorMessage").textContent = err.message;
    }
  });
}
  </script>
</body>
</html>
